/* Superslides - v0.6.3-wip - 2013-12-17
* https://github.com/nicinabox/superslides
* Copyright (c) 2013 Nic Aitch; Licensed MIT */
(function(d,a){var c,b="superslides";c=function(g,l){this.options=a.extend({play:false,animation_speed:600,animation_easing:"swing",animation:"slide",inherit_width_from:d,inherit_height_from:d,pagination:true,hashchange:false,scrollable:true,elements:{preserve:".preserve",nav:".slides-navigation",container:".slides-container",pagination:".slides-pagination"}},l);var n=this,e=a("<div>",{"class":"slides-control"}),k=1;this.$el=a(g);this.$container=this.$el.find(this.options.elements.container);var j=function(){k=n._findMultiplier();n.$el.on("click",n.options.elements.nav+" a",function(o){o.preventDefault();n.stop();if(a(this).hasClass("next")){n.animate("next",function(){n.start()})}else{n.animate("prev",function(){n.start()})}});a(document).on("keyup",function(o){if(o.keyCode===37){n.animate("prev")}if(o.keyCode===39){n.animate("next")}});a(d).on("resize",function(){setTimeout(function(){var o=n.$container.children();n.width=n._findWidth();n.height=n._findHeight();o.css({width:n.width,left:n.width});n.css.containers();n.css.images()},10)});if(n.options.hashchange){a(d).on("hashchange",function(){var o=n._parseHash(),p;p=n._upcomingSlide(o);if(p>=0&&p!==n.current){n.animate(p)}})}n.pagination._events();n.start();return n};var f={containers:function(){if(n.init){n.$el.css({height:n.height});n.$control.css({width:n.width*k,left:-n.width});n.$container.css({})}else{a("body").css({margin:0});n.$el.css({position:"relative",overflow:"hidden",width:"100%",height:n.height});n.$control.css({position:"relative",transform:"translate3d(0)",height:"100%",width:n.width*k,left:-n.width});n.$container.css({display:"none",margin:"0",padding:"0",listStyle:"none",position:"relative",height:"100%"})}if(n.size()===1){n.$el.find(n.options.elements.nav).hide()}},images:function(){var o=n.$container.find("img").not(n.options.elements.preserve);o.removeAttr("width").removeAttr("height").css({"-webkit-backface-visibility":"hidden","-ms-interpolation-mode":"bicubic",position:"absolute",left:"0",top:"0","z-index":"-1","max-width":"none"});o.each(function(){var q=n.image._aspectRatio(this),p=this;if(!a.data(this,"processed")){var r=new Image();r.onload=function(){n.image._scale(p,q);n.image._center(p,q);a.data(p,"processed",true)};r.src=this.src}else{n.image._scale(p,q);n.image._center(p,q)}})},children:function(){var o=n.$container.children();if(o.is("img")){o.each(function(){if(a(this).is("img")){a(this).wrap("<div>");var p=a(this).attr("id");a(this).removeAttr("id");a(this).parent().attr("id",p)}});o=n.$container.children()}if(!n.init){o.css({display:"none",left:n.width*2})}o.css({position:"absolute",overflow:"hidden",height:"100%",width:n.width,top:0,zIndex:0})}};var h={slide:function(r,q){var o=n.$container.children(),p=o.eq(r.upcoming_slide);p.css({left:r.upcoming_position,display:"block"});n.$control.animate({left:r.offset},n.options.animation_speed,n.options.animation_easing,function(){if(n.size()>1){n.$control.css({left:-n.width});o.eq(r.upcoming_slide).css({left:n.width,zIndex:2});if(r.outgoing_slide>=0){o.eq(r.outgoing_slide).css({left:n.width,display:"none",zIndex:0})}}q()})},fade:function(s,r){var t=this,o=t.$container.children(),p=o.eq(s.outgoing_slide),q=o.eq(s.upcoming_slide);q.css({left:this.width,opacity:0,display:"block"}).animate({opacity:1},t.options.animation_speed,t.options.animation_easing);if(s.outgoing_slide>=0){p.animate({opacity:0},t.options.animation_speed,t.options.animation_easing,function(){if(t.size()>1){o.eq(s.upcoming_slide).css({zIndex:2});if(s.outgoing_slide>=0){o.eq(s.outgoing_slide).css({opacity:1,display:"none",zIndex:0})}}r()})}else{q.css({zIndex:2});r()}}};h=a.extend(h,a.fn.superslides.fx);var i={_centerY:function(p){var o=a(p);o.css({top:(n.height-o.height())/2})},_centerX:function(p){var o=a(p);o.css({left:(n.width-o.width())/2})},_center:function(o){n.image._centerX(o);n.image._centerY(o)},_aspectRatio:function(o){if(!o.naturalHeight&&!o.naturalWidth){var p=new Image();p.src=o.src;o.naturalHeight=p.height;o.naturalWidth=p.width}return o.naturalHeight/o.naturalWidth},_scale:function(q,r){r=r||n.image._aspectRatio(q);var p=n.height/n.width,o=a(q);if(p>r){o.css({height:n.height,width:n.height/r})}else{o.css({height:n.width*r,width:n.width})}}};var m={_setCurrent:function(p){if(!n.$pagination){return}var o=n.$pagination.children();o.removeClass("current");o.eq(p).addClass("current")},_addItem:function(r){var t=r+1,q=t,p=n.$container.children().eq(r),s=p.attr("id");if(s){q=s}var o=a("<a>",{href:"#"+q,text:q});o.appendTo(n.$pagination)},_setup:function(){if(!n.options.pagination||n.size()===1){return}var o=a("<nav>",{"class":n.options.elements.pagination.replace(/^\./,"")});n.$pagination=o.appendTo(n.$el);for(var p=0;p<n.size();p++){n.pagination._addItem(p)}},_events:function(){n.$el.on("click",n.options.elements.pagination+" a",function(o){o.preventDefault();var p=n._parseHash(this.hash),q;q=n._upcomingSlide(p,true);if(q!==n.current){n.animate(q,function(){n.start()})}})}};this.css=f;this.image=i;this.pagination=m;this.fx=h;this.animation=this.fx[this.options.animation];this.$control=this.$container.wrap(e).parent(".slides-control");n._findPositions();n.width=n._findWidth();n.height=n._findHeight();this.css.children();this.css.containers();this.css.images();this.pagination._setup();return j()};c.prototype={_findWidth:function(){return a(this.options.inherit_width_from).width()},_findHeight:function(){return a(this.options.inherit_height_from).height()},_findMultiplier:function(){return this.size()===1?1:3},_upcomingSlide:function(e,f){if(f&&!isNaN(e)){e=e-1}if((/next/).test(e)){return this._nextInDom()}else{if((/prev/).test(e)){return this._prevInDom()}else{if((/\d/).test(e)){return +e}else{if(e&&(/\w/).test(e)){var g=this._findSlideById(e);if(g>=0){return g}else{return 0}}else{return 0}}}}},_findSlideById:function(e){return this.$container.find("#"+e).index()},_findPositions:function(e,f){f=f||this;if(e===undefined){e=-1}f.current=e;f.next=f._nextInDom();f.prev=f._prevInDom()},_nextInDom:function(){var e=this.current+1;if(e===this.size()){e=0}return e},_prevInDom:function(){var e=this.current-1;if(e<0){e=this.size()-1}return e},_parseHash:function(e){e=e||d.location.hash;e=e.replace(/^#/,"");if(e&&!isNaN(+e)){e=+e}return e},size:function(){return this.$container.children().length},destroy:function(){return this.$el.removeData()},update:function(){this.css.children();this.css.containers();this.css.images();this.pagination._addItem(this.size());this._findPositions(this.current);this.$el.trigger("updated.slides")},stop:function(){clearInterval(this.play_id);delete this.play_id;this.$el.trigger("stopped.slides")},start:function(){var e=this;if(e.options.hashchange){a(d).trigger("hashchange")}else{this.animate()}if(this.options.play){if(this.play_id){this.stop()}this.play_id=setInterval(function(){e.animate()},this.options.play)}this.$el.trigger("started.slides")},animate:function(e,j){var i=this,h={};if(this.animating){return}this.animating=true;if(e===undefined){e="next"}h.upcoming_slide=this._upcomingSlide(e);if(h.upcoming_slide>=this.size()){return}h.outgoing_slide=this.current;h.upcoming_position=this.width*2;h.offset=-h.upcoming_position;if(e==="prev"||e<h.outgoing_slide){h.upcoming_position=0;h.offset=0}if(i.size()>1){i.pagination._setCurrent(h.upcoming_slide)}if(i.options.hashchange){var f=h.upcoming_slide+1,g=i.$container.children(":eq("+h.upcoming_slide+")").attr("id");if(g){d.location.hash=g}else{d.location.hash=f}}i.$el.trigger("animating.slides",[h]);i.animation(h,function(){i._findPositions(h.upcoming_slide,i);if(typeof j==="function"){j()}i.animating=false;i.$el.trigger("animated.slides");if(!i.init){i.$el.trigger("init.slides");i.init=true;i.$container.fadeIn("fast")}})}};a.fn[b]=function(f,e){var g=[];this.each(function(){var h,i,j;h=a(this);i=h.data(b);j=typeof f==="object"&&f;if(!i){g=h.data(b,(i=new c(this,j)))}if(typeof f==="string"){g=i[f];if(typeof g==="function"){return g=g.call(i,e)}}});return g};a.fn[b].fx={}})(this,jQuery);